<Project>

    <Import Project="Tomat.Sisyphus.GamePath.targets"/>

    <UsingTask TaskName="AssemblyResolutionTask"
               AssemblyFile="Sisyphus.Build.dll"/>

    <!-- Set general build properties understood to be good defaults for any
         mods using sisyphus. -->
    <PropertyGroup>
        <DebugSymbols>true</DebugSymbols>
        <ProduceReferenceAssembly>false</ProduceReferenceAssembly>
    </PropertyGroup>

    <PropertyGroup>
        <OutDir>$(GamePath)/sisyphus/sisyphus-mods/$(AssemblyName)/</OutDir>
    </PropertyGroup>
    
    <!-- TODO: Cross-OS support. -->
    <PropertyGroup Condition="'$(OS)' == 'Windows_NT'">
        <StartAction>Program</StartAction>
        <StartProgram>$(GameRunPath)</StartProgram>
        <StartWorkingDirectory>$(GamePath)</StartWorkingDirectory>
    </PropertyGroup>

    <Target Name="AddAssemblies" BeforeTargets="ResolveAssemblyReferences">
        <AssemblyResolutionTask InputPath="$(GamePath)/ULTRAKILL_Data/Managed">
            <Output TaskParameter="Assemblies" ItemName="_Assemblies"/>
        </AssemblyResolutionTask>
        <ItemGroup>
            <Reference Include="@(_Assemblies)" Private="false"/>
        </ItemGroup>
    </Target>

</Project>